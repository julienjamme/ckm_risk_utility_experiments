# Analyzing the data
library(dplyr)
library(ggplot2)
library(purrr)

# theme plots
source("R/theme_for_ggplots.R")

# results are generated by R/results.R
load("all_RUs.RData")

all_RUs |> str()
all_RUs |> count(tab)

p <- ggplot(data = all_RUs)


# Utilité -------------------
p + geom_point(aes(x=tab, y=U3, color=V))

# U1 et U2 sont indépendantes du tableau:
q <- ggplot(data = all_RUs |> filter(tab == tab[1]))
q + 
  geom_point(aes(x=V, y=U1, color = as.factor(D)), alpha=0.6) +
  geom_line(aes(x=V, y=U1, group = D, color = as.factor(D)), alpha=0.6) 

q + 
  geom_point(aes(x=V, y=U2, color = as.factor(D)), alpha=0.6) +
  geom_line(aes(x=V, y=U2, group = D, color = as.factor(D)), alpha=0.6) 

# Restricttions aux tableaux du census
p1 <- ggplot(data = all_RUs |> filter(tab %in% c("freq_census_tab1","freq_census_tab2")))
p1 + 
  geom_point(aes(x=V, y=U3, color = as.factor(D)), alpha=0.8) +
  geom_line(aes(x=V, y=U3, group = D, color = as.factor(D))) +
  facet_grid(tab~js, label=labeller(js="label_both"))

p1 + 
  geom_point(aes(x=U1, y=U3, color = as.factor(tab), size = V), alpha=0.8) +
  geom_abline(slope=1,intercept=0,color="grey")

p1 + 
  geom_point(aes(x=U2, y=U4, color = as.factor(tab), size = V), alpha=0.8) +
  geom_abline(slope=1,intercept=0,color="grey")

# Risque -------------------
p1 + 
  geom_point(aes(x=V, y=R1, color = as.factor(D)), alpha=0.55) +
  geom_line(aes(x=V, y=R1, group = D, color = as.factor(D)), alpha=0.55) +
  facet_grid(tab~js, label=labeller(js="label_both"))

p1 + 
  geom_point(aes(x=V, y=R2, color = as.factor(D)), alpha=0.55) +
  geom_line(aes(x=V, y=R2, group = D, color = as.factor(D)), alpha = 0.55) +
  facet_grid(tab~js, label=labeller(js="label_both"))


# Risque / Utilité -------------------



